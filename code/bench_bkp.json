{
    "title" : "Ubuntu 16.04 CIS Benchmark",
    "compiled_by": "epeisam",
    "compiled_on": "2021/10/12",
    "items" : [
        {
            "name":"1.1.1.1 Ensure mounting of cramfs filesystems is disabled",
            "audit": [
                {
                    "cmd":"modprobe -n -v cramfs",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "install /bin/true",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "cmd":"lsmod | grep cramfs",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]  
                }
                
            ]
        },
        {
            "name":"1.1.1.2 Ensure mounting of freevxfs filesystems is disabled",
            "audit": [
                {
                    "cmd":"modprobe -n -v freevxfs",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "install /bin/true",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "cmd":"lsmod | grep freevxfs",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]  
                }
                
            ]
        },
        {
            "name":"1.1.1.3 Ensure mounting of jffs2 filesystems is disabled",
            "audit": [
                {
                    "cmd":"modprobe -n -v jffs2",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "install /bin/true",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "cmd":"lsmod | grep jffs2",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                    
            ]
        },


        {
            "name":"1.1.1.4 Ensure mounting of hfs filesystems is disabled",
            "audit": [
                {
                    "cmd":"modprobe -n -v hfs",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "install /bin/true",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "cmd":"lsmod | grep hfs",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                    
            ]
        },


        {
            "name":"1.1.1.5 Ensure mounting of hfsplus filesystems is disabled",
            "audit": [
                {
                    "cmd":"modprobe -n -v hfsplus",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "install /bin/true",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "cmd":"lsmod | grep hfsplus",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                    
            ]
        },


        {
            "name":"1.1.1.6 Ensure mounting of squashfs filesystems is disabled",
            "audit": [
                {
                    "cmd":"modprobe -n -v squashfs",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "install /bin/true",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "cmd":"lsmod | grep squashfs",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                    
            ]
        },
    

        {
            "name":"1.1.1.7 Ensure mounting of udf filesystems is disabled",
            "audit": [
                {
                    "cmd":"modprobe -n -v udf",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "install /bin/true",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "cmd":"lsmod | grep udf",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                    
            ]
        },

        
        {
            "name":"1.1.1.8 Ensure mounting of FAT filesystems is disabled",
            "audit": [
                {
                    "cmd":"modprobe -n -v vfat",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "install /bin/true",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "cmd":" lsmod | grep vfat",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                    
            ]
        },

        {
            "name":"1.1.2 Ensure separate partition exists for /tmp",
            "audit": [
                {
                    "cmd":"mount | grep /tmp",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /tmp type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },
        {
            "name":"1.1.3 Ensure nodev option set on /tmp partition",
            "audit": [
                {
                    "cmd":"mount | grep /tmp",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /tmp type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "nodev",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },
        {
            "name":"1.1.4 Ensure nosuid option set on /tmp partition",
            "audit": [
                {
                    "cmd":"mount | grep /tmp",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /tmp type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "nosuid",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },
    
        {
            "name":"1.1.5 Ensure separate partition exists for /var",
            "audit": [
                {
                    "cmd":"mount | grep /var",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /var type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },   
        
        
        {
            "name":"1.1.6 Ensure separate partition exists for /var/tmp",
            "audit": [
                {
                    "cmd":"mount | grep /var/tmp",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /var/tmp type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },  

        {
            "name":"1.1.7 Ensure nodev option set on /var/tmp partition",
            "audit": [
                {
                    "cmd":"mount | grep /var/tmp",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /var/tmp type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "nodev",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },  

        {
            "name":"1.1.8 Ensure nosuid option set on /var/tmp partition",
            "audit": [
                {
                    "cmd":"mount | grep /var/tmp",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /var/tmp type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "nosuid",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },  
    
        {
            "name":"1.1.9 Ensure noexec option set on /var/tmp partition",
            "audit": [
                {
                    "cmd":"mount | grep /var/tmp",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /var/tmp type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "noexec",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },  

        {
            "name":"1.1.10 Ensure separate partition exists for /var/log",
            "audit": [
                {
                    "cmd":"mount | grep /var/log",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /var/log type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },  

        {
            "name":"1.1.11 Ensure separate partition exists for /var/log/audit",
            "audit": [
                {
                    "cmd":"mount | grep /var/log/audit",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /var/log/audit type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        }, 

        {
            "name":"1.1.11 Ensure separate partition exists for /var/log/audit",
            "audit": [
                {
                    "cmd":"mount | grep /home",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /home type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        }, 

        {
            "name":"1.1.13 Ensure nodev option set on /home partition",
            "audit": [
                {
                    "cmd":"mount | grep /home",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /home type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "nodev",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        }, 
        {
            "name":"1.1.14 Ensure nodev option set on /dev/shm partition",
            "audit": [
                {
                    "cmd":"mount | grep /dev/shm",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /dev/shm type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        }, 

        {
            "name":"1.1.15 Ensure nosuid option set on /dev/shm partition",
            "audit": [
                {
                    "cmd":"mount | grep /dev/shm",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /dev/shm type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "nosuid",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        }, 
        {
            "name":"1.1.16 Ensure noexec option set on /dev/shm partition",
            "audit": [
                {
                    "cmd":"mount | grep /dev/shm",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /dev/shm type",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "noexec",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },

        {
            "name":"1.1.17 Ensure nodev option set on removable media partitions",
            "audit": [
                {
                    "cmd":"mount | grep /dev/sd",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /dev/sd",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "nodev",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "pass_if_no_lines",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },

        {
            "name":"1.1.17 Ensure nodev option set on removable media partitions",
            "audit": [
                {
                    "cmd":"mount | grep /dev/sd",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /dev/sd",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "nosuid",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "pass_if_no_lines",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        }

                    ]
                }                 
            ]
        },

        {
            "name":"1.1.19 Ensure noexec option set on removable media partitions",
            "audit": [
                {
                    "cmd":"mount | grep /dev/sd",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "on /dev/sd",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "noexec",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "pass_if_no_lines",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },

        {
            "name":"1.1.20 Ensure sticky bit is set on all world-writable directories",
            "audit": [
                {
                    "cmd":"df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d -perm -0002 -a ! -perm -1000 2>/dev/null",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "pass_if_no_lines",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },

        {
            "name":"1.1.21 Disable Automounting",
            "audit": [
                {
                    "cmd":"systemctl is-enabled autofs",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },

        {
            "name":"1.2.1 Ensure package manager repositories are configured",
            "audit": [
                {
                    "cmd":"apt-cache policy",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "pass_if_lines",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },
        {
            "name":"1.3.1 Ensure AIDE is installed",
            "audit": [
                {
                    "cmd":"dpkg -s aide",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "install ok installed",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },
        {
            "name":"1.3.2 Ensure filesystem integrity is regularly checked",
            "audit": [
                {
                    "cmd":"crontab -u root -l | grep aide",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "pass_if_lines",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "cmd":"grep -r aide /etc/cron.* /etc/crontab",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "pass_if_lines",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }                 
            ]
        },

        {
            "name":"1.4.1 Ensure permissions on bootloader config are configured",
            "audit": [
                {
                    "cmd":"stat /boot/grub/grub.cfg",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "Access: (0600/-rw-------)  Uid: (    0/    root)   Gid: (    0/    root)",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }           
            ]
        },

        {
            "name":"1.4.2 Ensure bootloader password is set",
            "audit": [
                {
                    "cmd":"grep '^set superusers' /boot/grub/grub.cfg",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "set superusers=",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "cmd":"grep '^password' /boot/grub/grub.cfg",
                    "elevated" : true,
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "password_pbkdf2",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }            
            ]
        },
        {
            "name":"1.4.3 Ensure authentication required for single user mode",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"grep ^root:[*\\!]: /etc/shadow",
                    "response_conditions":[
                        {
                            "condition": "pass_if_no_lines",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }         
            ]
        },
        {
            "name":"1.5.1 Ensure core dumps are restricted",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"grep 'hard core' /etc/security/limits.conf /etc/security/limits.d/*",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "hard core 0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"sysctl fs.suid_dumpable",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "fs.suid_dumpable = 0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }         
            ]
        },
        {
            "name":"1.5.2 Ensure XD/NX support is enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"dmesg | grep NX",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "NX (Execute Disable) protection: active",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }      
            ]
        },
        {
            "name":"1.5.3 Ensure address space layout randomization (ASLR) is enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"sysctl kernel.randomize_va_space",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "kernel.randomize_va_space = 2",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }      
            ]
        },
        {
            "name":"1.5.4 Ensure prelink is disabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"dpkg -s prelink",
                    "response_conditions":[
                        {
                            "condition": "pass_if_no_lines",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }      
            ]
        },
        {
            "name":"1.6.1.1 Ensure SELinux is not disabled in bootloader configuration",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"grep '^\\s*linux' /boot/grub/grub.cfg",
                    "response_conditions":[
                        {
                            "condition": "not_like",
                            "not_like_to": "selinux=0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "not_like",
                            "not_like_to": "enforcing=0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }      
            ]
        },
        {
            "name":"1.6.1.2 Ensure the SELinux state is enforcing",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"grep SELINUX=enforcing /etc/selinux/config",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "SELINUX=enforcing",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"sestatus",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "SELinux status: enabled",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Current mode: enforcing",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }        
            ]
        },
        {
            "name":"1.6.1.3 Ensure SELinux policy is configured",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"grep SELINUXTYPE= /etc/selinux/config",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "SELINUXTYPE=ubuntu",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"sestatus",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "Policy from config file: ubuntu",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }        
            ]
        },
        {
            "name":"1.6.1.4 Ensure no unconfined daemons exist",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"ps -eZ | egrep 'initrc' | egrep -vw 'tr|ps|egrep|bash|awk' | tr ':' ' ' | awk '{ print $NF }'",
                    "response_conditions":[
                        {
                            "condition": "pass_if_no_lines",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"1.6.2.1 Ensure AppArmor is not disabled in bootloader configuration",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"grep '^\\s*linux' /boot/grub/grub.cfg",
                    "response_conditions":[
                        {
                            "condition": "not_like",
                            "not_like_to": "apparmor=0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }    
            ]
        },
        {
            "name":"1.6.2.2 Ensure all AppArmor Profiles are enforcing",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"apparmor_status",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "0 profiles are in complain mode",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "0 processes are in complain mode",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "0 processes are unconfined",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }    
            ]
        },
        {
            "name":"1.6.3 Ensure SELinux or AppArmor are installed",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"dpkg -s selinux",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "install ok installed",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"dpkg -s apparmor",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "install ok installed",
                            "control_flag" : "required",
                            "on" : "stdout"
                            
                        }
                    ]
                }    
            ]
        },
        {
            "name":"1.7.1.1 Ensure message of the day is configured properly",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"cat /etc/motd",
                    "response_conditions":[
                        {
                            "condition": "pass_if_lines",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"egrep '(\\v|\\r|\\m|\\s)' /etc/motd",
                    "response_conditions":[
                        {
                            "condition": "pass_if_no_lines",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"1.7.1.4 Ensure permissions on /etc/motd are configured",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"stat /etc/motd",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to" : "Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                } 
            ]
        },  
        {
            "name":"1.7.1.5 Ensure permissions on /etc/issue are configured",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"stat /etc/issue",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to" : "Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                } 
            ]
        },
        {
            "name":"1.7.1.6 Ensure permissions on /etc/issue.net are configured",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"stat /etc/issue.net",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to" : "Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                } 
            ]
        },
        {
            "name":"1.8 Ensure updates, patches, and additional security software are installed",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"apt-get -s upgrade",
                    "response_conditions":[
                        {
                            "condition": "not_like",
                            "not_like_to" : "The following packages will be upgraded",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                } 
            ]
        },
        {
            "name":"2.1.10 Ensure xinetd is not enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled xinetd",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to" : "disabled",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                } 
            ]
        },
        {
            "name":"2.1.10-A Ensure openbsd-inetd is not installed",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"dpkg -s openbsd-inted",
                    "response_conditions":[
                        {
                            "condition": "not_like",
                            "not_like_to": "install ok installed",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                } 
            ]
        },
        {
            "name":"2.2.1.1 Ensure time synchronization is in use",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"dpkg -s ntp",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "install ok installed",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"dpkg -s chrony",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "install ok installed",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                } 
            ]
        },
        {
            "name":"2.2.1.2 Ensure ntp is configured",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"grep '^restrict' /etc/ntp.conf",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "restrict -4 default kod nomodify notrap nopeer noquery",
                            "control_flag" : "required",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "restrict -6 default kod nomodify notrap nopeer noquery",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "elevated" : true,
            "cmd":"grep '^server' /etc/ntp.conf",
            "response_conditions":[
                {
                    "condition": "like",
                    "like_to": "server ",
                    "control_flag" : "required",
                    "on" : "stdout"
                }
            ]
        },
        {
            "name":"2.2.2 Ensure X Window System is not installed",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"dpkg -l xserver-xorg*",
                    "response_conditions":[
                        {
                            "condition": "not_like",
                            "not_like_to": "install ok installed",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"2.2.3 Ensure Avahi Server is not enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled avahi-daemon",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                }
            ]
        },
        {
            "name":"2.2.4 Ensure CUPS is not enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled cups",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                }
            ]
        },

        {
            "name":"2.2.5 Ensure DHCP Server is not enabled ",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":" systemctl is-enabled isc-dhcp-server",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled isc-dhcp-server6",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                }
            ]
        },
        {
            "name":"2.2.6 Ensure LDAP server is not enabled ",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled slapd",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                }
            ]
        },
        
        {
            "name":"2.2.7 Ensure NFS and RPC are not enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled nfs-kernel-server",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":" systemctl is-enabled rpcbind",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                }
            ]
        },
        {
            "name":"2.2.8 Ensure DNS Server is not enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled bind9",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                }
            ]
        },
        {
            "name":"2.2.9 Ensure FTP Server is not enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled vsftpd",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                }
            ]
        },
        {
            "name":"2.2.10 Ensure HTTP server is not enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled apache2",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                }
            ]
        },
        {
            "name":"2.2.11 Ensure IMAP and POP3 server is not enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled dovecot",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                }
            ]
        },
        {
            "name":"2.2.12 Ensure Samba is not enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled smbd",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                }
            ]
        },
        {
            "name":"2.2.13 Ensure HTTP Proxy Server is not enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled squid",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                }
            ]
        },
        {
            "name":"2.2.14 Ensure SNMP Server is not enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled snmpd",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                        
                    ]
                }
            ]
        },
        {
            "name":"2.2.15 Ensure mail transfer agent is configured for local-only mode",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"netstat -an | grep LIST | grep ':25[[:space:]]'",
                    "response_conditions":[
                        {
                            "condition": "pass_if_no_lines",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"2.2.16 Ensure rsync service is not enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled rsync",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                    ]
                }
            ]
        },
        {
            "name":"2.2.17 Ensure NIS Server is not enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"systemctl is-enabled nis",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "disabled",
                            "control_flag" : "optional",
                            "on" : "stdout"
                        },
                        {
                            "condition": "like",
                            "like_to": "Failed to get unit file state",
                            "control_flag" : "optional",
                            "on" : "stderr"
                        }
                    ]
                }
            ]
        },
        {
            "name":"2.3.1 Ensure NIS Client is not installed",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"dpkg -s nis",
                    "response_conditions":[
                        {
                            "condition": "not_like",
                            "not_like_to": "install ok installed",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"2.3.2 Ensure rsh client is not installed",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"dpkg -s rsh-client",
                    "response_conditions":[
                        {
                            "condition": "not_like",
                            "not_like_to": "install ok installed",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"dpkg -s rsh-redone-client",
                    "response_conditions":[
                        {
                            "condition": "not_like",
                            "not_like_to": "install ok installed",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"2.3.3 Ensure talk client is not installed",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"dpkg -s talk",
                    "response_conditions":[
                        {
                            "condition": "not_like",
                            "not_like_to": "install ok installed",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"2.3.4 Ensure telnet client is not installed",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"dpkg -s telnet",
                    "response_conditions":[
                        {
                            "condition": "not_like",
                            "not_like_to": "install ok installed",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"2.3.5 Ensure LDAP client is not installed",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"dpkg -s ldap-utils",
                    "response_conditions":[
                        {
                            "condition": "not_like",
                            "not_like_to": "install ok installed",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"3.1.1 Ensure IP forwarding is disabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.ip_forward",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.ip_forward = 0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"3.1.2 Ensure packet redirect sending is disabled ",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.conf.all.send_redirects",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.conf.all.send_redirects = 0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.conf.default.send_redirects",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.conf.default.send_redirects = 0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"3.2.1 Ensure source routed packets are not accepted",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.conf.all.accept_redirects",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.conf.all.accept_redirects = 0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.conf.default.accept_redirects",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.conf.default.accept_redirects = 0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"3.2.3 Ensure secure ICMP redirects are not accepted",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.conf.all.secure_redirects",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.conf.all.secure_redirects = 0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.conf.default.secure_redirects",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.conf.default.secure_redirects = 0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"3.2.4 Ensure suspicious packets are logged",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.conf.all.log_martians",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.conf.all.log_martians = 1",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.conf.default.log_martians",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.conf.default.log_martians = 1",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"3.2.5 Ensure broadcast ICMP requests are ignored",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.icmp_echo_ignore_broadcasts",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.conf.all.log_martians = 1",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"3.2.6 Ensure bogus ICMP responses are ignored",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.icmp_ignore_bogus_error_responses",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.icmp_ignore_bogus_error_responses = 1",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"3.2.7 Ensure Reverse Path Filtering is enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.conf.all.rp_filter",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.conf.all.rp_filter = 1",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.conf.default.rp_filter",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.conf.default.rp_filter = 1",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"3.2.8 Ensure TCP SYN Cookies is enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.tcp_syncookies",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.tcp_syncookies = 1",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"3.2.8 Ensure TCP SYN Cookies is enabled",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv4.tcp_syncookies",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv4.tcp_syncookies = 1",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        },
        {
            "name":"3.3.1 Ensure IPv6 router advertisements are not accepted",
            "audit": [
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv6.conf.all.accept_ra",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv6.conf.all.accept_ra = 0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                },
                {
                    "elevated" : true,
                    "cmd":"sysctl net.ipv6.conf.default.accept_ra",
                    "response_conditions":[
                        {
                            "condition": "like",
                            "like_to": "net.ipv6.conf.all.accept_ra = 0",
                            "control_flag" : "required",
                            "on" : "stdout"
                        }
                    ]
                }
            ]
        }

    ]
}